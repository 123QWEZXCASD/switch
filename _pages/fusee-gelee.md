---
permalink: /fusee-gelee.html
title: Запуск пейлоадера через Fusée Gelée
author_profile: true
---
{% include toc title="Разделы" %}

# Что такое Fusée Gelée? 

Некоторые мобильные процессоры NVIDIA Tegra, выпущенные до 2016 года, содержат Уязвимость переполнения буфера в режиме восстановления BootROM (RCM). Злоумышленник с физическим доступом к USB устройства и возможностью принудительной перезагрузки устройства в RCM может использовать уязвимость для выполнения непроверенного кода.

Fusée Gelée - это цепочка эксплойтов для Nintendo Switch, построенная вокруг аппаратной уязвимости чипа Nvidia Tegra. С её помощью можно будет запускать не подписанный код на Nintendo Switch. Поскольку уязвимость аппаратная, её невозможно закрыть на текущей ревизии железа. 

# Что такое RCM? 

RCM - это штатный режим восстановления на Tegra-устройствах. Для того, чтобы войти в него, нужно выключить консоли, а затем зажать (POWER) + (VOL+) + (HOME). Но не тот (HOME), что мы видим на правом джойконе, а кнопку которую NVIDIA Tegra считает таковой. К сожалению, на самой приставке её нет. , нам понадобится отключить консоль, замкнуть определённый контакт на месте крепления правого joy-con и землю (для этого используется замыкатель), подключить консоль к ПК и отправить на неё пейлоадер любым удобным способом. Ниже мы рассмотрим подробнее как это делать.

# Как все это происходит

В общем виде цепочка такая - вы вставляете [замыкатель](#замыкатель) в приставку, подключаете её к хосту (ПК, смартфон, донгл - все это хосты) и загружаете через хост на приставку пейлоад, который уже и запускает пропатченные модули. Фундоментальный минус в том, что каждый раз для запуска прошивки на приставке вам нужно иметь доступ к хосту, что не всегда удобно. Например, в поездку с собой брать приставку накладно - в случае зависания придется доставать телефон, кабеля и запускать пейлоад. Выхода в данный момент два - покупка донгла и установка в приставку чипа. Установку чипа в Украине [можно заказать у меня](https://www.olx.ua/obyavlenie/proshivka-nintendo-switch-ustanovka-nastroyka-chipovka-IDBbLSh.html){:target="_blank"}. 

# Что понадобится

Хост - устройство, с которого приставка будет получать <abbr title="файлы с исполняемым кодом в формате `.bin`, которые мы загружаем в приставку, чаще всего - загрузчики">пейлоад</abbr>. В качетсве хоста может выступать компьютер, донгл, модчип или телефон с которого вы будете передавать пейлоад на Switch. 
{: .notice--info}

* Замыкатель (подробнее ниже)
* Карта памяти 
* Хост с подготовленным пейлоадом и возможность подключить к нему Switch (например, если хост ПК, понадобится кабель USB type C)

## Замыкатель 

Для корректной активации цепочки нам понадобится замкнуть между собой 1-й и 10-й контакты (либо 7-й и 10-й, оба варианта работают одинаково хорошо) на месте установки правого контроллера. Это можно сделать несколькими способами: 

* Использовать обычную [канцелярскую скрепку](https://www.reddit.com/r/SwitchHacks/comments/8f0ugz/hardwarediy_switch_paperclip_jig_for_rcm_mode/){:target="_blank"}
* Использовать [кусочек фольги](https://xghostboyx.github.io/RCM-Guide/#tin_foil){:target="_blank"}
* Спаять между собой контакты непосредственно в самом joy-con [напрямую, или через резистор](https://xghostboyx.github.io/RCM-Guide/#soldered_joycon_710){:target="_blank"}
* [Вмонтировать в правый joy-con кнопку](https://www.reddit.com/r/SwitchHaxing/comments/8ho4h0/modded_my_joycon_to_have_a_clear_case_and_home/){:target="_blank"}
* Использовать [замыкатель, распечатанный на 3D-принтере](https://www.thingiverse.com/thing:2877484){:target="_blank"} (вы можете купить уже готовый: <a href="https://www.olx.ua/obyavlenie/nintendo-switch-rcm-jig-IDAWSI6.html" target="_blank"><img src="/images/ua.png" alt="Украина" style="vertical-align: baseline !important;"></a>, <a href="https://vk.com/market-102933233?w=product-102933233_2039087_23eff2d92b12968546" target="_blank"><img src="/images/ru.png" alt="Россия" style="vertical-align: baseline !important;"></a>)
* И другие [более странные методы](https://xghostboyx.github.io/RCM-Guide/){:target="_blank"}

Далее в инструкции будет фигурировать именно замыкатель, однако помните, что все эти способы релевантны. 

# Инструкция

## Часть I - Вход в RCM

Если вы используете AutoRCM, переходите сразу к следующей части

1. Если в приставку вставлен картридж - вытащите его
1. Выключите консоль
1. Подключите ваш USB type C кабель к хосту
1. Отсоедините правый joy-con
1. Вставьте [замыкатель](#замыкатель) в направляющую правого джойкона до упора 

	![](https://cdn.thingiverse.com/renders/a7/54/70/c4/3a/52e69bd058c5f59ef94f53c6d81c93c2_preview_featured.jpg) 
	{: .text-center}
	{: .notice--info}
	
1. Зажмите (VOL+) и вставьте ваш USB type C кабель, подключённый к хосту, в Switch

На экране приставки не должно ничего происходить. Если после подключения кабеля экран остаётся чёрным, то вы все делаете правильно! Если экран загорается надписью Nintendo - отключите консоль и повторите всё заново. 

В общем случае переход в RCM осуществляется одновременным зажатием (POWER) + (VOL+) на выключенной приставке при вставленном замыкателе. В этой инструкции вставленный кабель, подключенный к хосту, включает приставку, что эквивалентно нажатию кнопки (POWER)
{: .notice--info}

Может не получаться по следующим причинам:
* Замкнуты не те контакты
* Замыкатель ничего не замыкает, например проволока порвалась и контакты не замыкаются, или он изначально собран с ошибками
* Кнопки зажаты не одновременно. Пробуйте зажимать вначале (VOL+), а затем, не отпуская её, нажмите (POWER)

## Часть II - Использование Fusée Gelée

Выберите платформу, которая будет использоваться в качестве хоста:

* [Запуск через донгл](#запуск-через-донгл)
* [Запуск на Windows](#запуск-на-windows)
* [Запуск на Linux\MacOS\ChromeOS\Android](#запуск-на-linux--macos--chromeos--android)

___

# Запуск через донгл 

## R4s Dongle

### Что понадобится

* [R4s Dongle](https://vk.com/market-125012133?w=product-125012133_1694790%2Fquery){:target="_blank"}
* [Установленная на донгле hekate 4](r4#прошивка-донгла){:target="_blank"}
* Пейлоад, который вы собираетесь запускать
	* Для запуска hekate она должна быть [прошита в донгл](r4#прошивка-донгла){:target="_blank"}, дополнительно её никуда не нужно скидывать
* Приставка должна быть в [режиме RCM](fusee-gelee#часть-i---вход-в-rcm){:target="_blank"}

Донгл необходимо зарядить комплектным кабелем, либо вставить во **включённую** приставку
{: .notice--warning}

### Запуск пейлоада

Приставка должна находиться в [режиме RCM](fusee-gelee#часть-i---вход-в-rcm){:target="_blank"}!
{: .notice--info}

1. Вставьте карту памяти приставки в ПК 
	* Приставка находится в режиме RCM, вы можете свободно извлекать из неё карту безо всяких дополнительных манипуляций. Выключать для извлечения карты приставку не нужно, иначе придётся снова вводить её в режим RCM
1. Поместите пейлоад, который вы собираетесь запускать в папку `bootloader/payloads`
1. Вставьте карту памяти обратно в консоль
1. Вставьте донгл в консоль
	* Для запуска hekate донгл быть [должен быть прошит](r4#прошивка-донгла){:target="_blank"}. hekate запустится сразу, как только вы вставили донгл в консоль в режиме RCM. Если ваша цель была запуск hekate - вы её достигли, можете доставать [замыкатель](#замыкатель) 
1. На экране приставки появится меню загрузчика hekate
	* Для перемещения по меню, hekata используйте клавиши (VOL-) и (VOL+), для выбора - (POWER)
1. Выберите **Launch -> Payloads... -> %ваш_пейлоад%.bin**
1. Пейлоад запустится на консоли
1. Можете доставать [замыкатель](#замыкатель)

## SX OS Pro / R4S Dongle с прошитым пейлоадом от SX OS

### Что понадобится

* Xecuter Dongle, входящий в комплект SX PRO 
	* Либо [R4s Dongle](https://vk.com/market-125012133?w=product-125012133_1694790%2Fquery){:target="_blank"} с [прошитым пейлоадом от SX OS](r4#прошивка-донгла){:target="_blank"}
* Пейлоад, который вы собираетесь запускать
* Поместите {% include /vars/sxos.txt %} SX OS в корень карты памяти приставки
* Приставка должна быть в [режиме RCM](fusee-gelee#часть-i---вход-в-rcm){:target="_blank"}

Донгл необходимо зарядить комплектным кабелем, либо вставить во **включённую** приставку
{: .notice--warning}

### Запуск пейлоада

Приставка должна находиться в [режиме RCM](fusee-gelee#часть-i---вход-в-rcm){:target="_blank"}!
{: .notice--info}

1. Вставьте карту памяти приставки в ПК 
	* Приставка находится в режиме RCM, вы можете свободно извлекать из неё карту безо всяких дополнительных манипуляций. Выключать для извлечения карты приставку не нужно, иначе придётся снова вводить её в режим RCM
1. Поместите пейлоад, который вы собираетесь запускать в корень карты памяти
1. Вставьте карту памяти обратно в консоль
1. Вставьте донгл в консоль
1. При появлении загрузочного экрана SX OS, зажмите и удерживайте (VOL+) ([замыкатель](#замыкатель) должен быть вставлен в Switch)
1. Приставка загрузится в меню SX OS 
1. Выберите "Options"
1. Выберите "Launch external payload"
1. Выберите пейлоад, который хотите запустить
1. Пейлоад запустится на консоли
1. Можете доставать замыкатель

___

# Запуск на Windows

## Что понадобится

* Последняя версия [Zadig](http://zadig.akeo.ie/downloads/zadig.exe){:target="_blank"}
* Свежая версия [TegraRcmSmash](https://switchtools.sshnuke.net/){:target="_blank"}
* Пейлоад, который вы собираетесь запускать на приставке
* USB type С на USB type A кабель для подключения Switch к ПК 
* Приставка должна быть в [режиме RCM](fusee-gelee#часть-i---вход-в-rcm){:target="_blank"}

## Установка драйверов 

Если драйвера уже были установлены, пропустите эту часть

1. Запустите `Zadig.exe` от имени Администратора 
1. В верхнем поле (на изображении '1') вы должны увидеть строку "APX" (иногда "Unknown Device")
	* Если там ничего нет, вы либо не ввели Switch в RCM, либо не подключили его после этого к ПК 

	![](/images/screenshots/zadig.png) 
	{: .text-center}
	{: .notice--info}
	
1. В поле "Driver" (на изображении '2') выберите `libusbK (v3.0.7.0)`
1. Нажмите "Install Driver"
1. После успешной установки драйвера нажмите "Close" и закройте программу 

## Запуск пейлоада

Приставка должна находиться в [режиме RCM](fusee-gelee#часть-i---вход-в-rcm){:target="_blank"}!
{: .notice--info}

1. Откройте архив с TegraRcmSmash
1. Перейдите в папку `Win32` и перетащите из архива `TegraRcmSmash.exe` в любую удобную для вас папку
	* В дальнейшем в эту папку так же будут складываться пейлоадеры и вам каждый раз придётся ей пользоваться для запуска взлома, имейте это ввиду
1. В эту же папку закиньте пейлоад, который планируете запускать 
	* В одной папке должна находится программа `TegraRcmSmash.exe` и необходимый `.bin` пейлоада
1. Перетяните пейлоад на `TegraRcmSmash.exe`
1. Пейлоад запустится на консоли
	* Если пейлоад не запускается проверьте правильно ли установлены драйвера. Правильно установленный драйвер устройства будет отображаться в диспетчере устройств в списке `libusbK USB Devices`
	* Попробуйте передать пейлоад еще раз
1. Можете доставать замыкатель
	
___

# Запуск на Linux \ MacOS \ ChromeOS \ Android

## Что понадобится

* Пейлоад, который вы собираетесь запускать на приставке
* USB type С на USB type A кабель для подключения Switch к ПК
* Браузер Chrome (с другими браузерами работать не будет!)
* Приставка должна быть в [режиме RCM](fusee-gelee#часть-i---вход-в-rcm){:target="_blank"}

## Запуск пейлоада

Приставка должна находиться в [режиме RCM](fusee-gelee#часть-i---вход-в-rcm){:target="_blank"}!
{: .notice--info}

1. Откройте эту [веб-страницу](https://elijahzawesome.github.io/web-cfw-loader/){:target="_blank"} и включите Русский язык
1. В части "Настройки отправки пейлоада" выберите пейлоад из списка "Загрузить свой пейлоад", нажмите "Выберите файл", после чего выберите `.bin`-файл вашего пейлоада
	* Не выбирайте пейлоад из списка! Используйте тот, что в архиве, иначе вы рискуете получить ошибку на том или ином этапе прошивки! 
1. Нажмите "Deliver payload!"
1. В открывшемся окне выберите "APX" и нажмите "Подключение"
1. Пейлоад запустится на консоли
1. Можете доставать замыкатель