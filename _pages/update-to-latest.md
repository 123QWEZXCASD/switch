---
permalink: /update-to-latest.html
title: Безопасное обновление прошивки 
author_profile: true
---
{% include toc title="Разделы" %}

# Теоретическая часть

Для удобства использования взлома в данный момент лучшим решением будет обновить прошивку до актуальной - {% include /vars/sys_version.txt %}. Однако, если ваша прошивка была ниже, чем 4.0.0, то обновившись вы рискуете остаться без колдбута, который, возможно, когда-нибудь нам подарят авторы атмосферы. Наиболее правильным решением в такой ситуации будет обновление с возможностью даунгрейда. 

В обычном режиме при установке прошивки, консоль проверяет количество сожжённых предохранителей. Если это количество больше, чем требуется для прошивки, то консоль понимает, что вы пытаетесь установить прошивку ниже, чем была установлена до этого и не позволит это сделать. Если же количество сожжённых предохранителей ниже, чем требует устанавливаемая прошивка, то прошивка разрешается и в ходе неё сжигается столько предохранителей сколько необходимо, чтобы соответствовать указанному в прошивке количеству. Таким образом вы не можете восстановить бекап своей старой прошивки, если её версия ниже, чем текущая.

Однако, все это можно обойти. 

Если вы обновляетесь с прошивки ниже, чем 4.0.0, то при восстановлении оригинальной прошивки у вас перестанет работать слот для картриджей. Сам слот останется в порядке, просто его прошивка обновится и перестанет быть совместимой с прошивками свитча ниже, чем 4.0.0. Избежать этого могут только пользователи CFW, потому что только у них есть возможность загружать готовые модули в систему. Ещё раз - **если вы используете CFW и обновляете вашу приставку с прошивок версии ниже, чем 4.0.0, то при возвращении на эту прошивку у вас не будет работать слот для картриджа**, если вы не примете меры. Это значит, что слот не будет работать ТОЛЬКО на прошивке ниже, чем 4.0.0. На любой прошивке выше он будет работать в обычном режиме! Хорошенько подумайте, готовы ли вы принести его в жертву! Очень маловероятно, что вам понадобится слот для картриджа, если вам по какой-то причине понадобится восстановиться до старой прошивки и если вы надумали использовать консоль на полную, то другого варианта в данный момент у вас нет. Пользователи SX OS не имеют возможности избежать прошивки слота, поскольку не имеют возможности загружать внешние модули. 
{: .notice--danger}

Обязательно сделайте резервную копию всех сохранений и важных данных, если таковые имеются, с помощью [Homebrew Launcher](launch-hbl){:target="_blank"} и соответствующей программы!
{: .notice--warning}

# Что понадобится

* Умение [запускать пейлоады через Fusée Gelée](fusee-gelee){:target="_blank"}
* Свежая версия пейлоада {% include inc/hekate.txt %}
* Свежая версия [SDFiles от rashevskyv](https://github.com/rashevskyv/switch/releases/latest){:target="_blank"}
* Свежая версия [briccmii](https://switchtools.sshnuke.net/){:target="_blank"}
* MicroSD в формате exFAT

# Инструкция

### Подготовительные работы 

1. Выключите Switch и вставьте его карту памяти в ПК 
1. Отформатируйте карту, которую собираетесь использовать в exFAT стандартными средствами вашей ОС, если она в другой файловой системе
	* Это удалит все данные с карты. Сделайте резервные копию всех важных данных, перед форматированием!
1. Скопируйте содержимое `.zip`-архива [SDFiles от rashevskyv](https://github.com/rashevskyv/switch/releases/latest){:target="_blank"} в корень карты памяти

Если вы захотите запустить другую конфигурацию hekate, не забудьте добавить строку `kip1=kip1patch=nogc,nosigchk` в конфиг. Помните, что запуск любой другой прошивки без этого патча приведут к обновлению прошивки слота и при даунгрейде на прошивку ниже, чем 4.0.0 он перестанет работать! Это значит, что слот не будет работать ТОЛЬКО на прошивке ниже, чем 4.0.0. На любой прошивке выше он будет работать в обычном режиме! 
{: .notice--warning}		

## Часть I - Резервное копирование NAND

Этот пункт нужно делать **обязательно**! 
{: .notice--warning}

1. Создайте [резервную копию NAND](backup-nand){:target="_blank"} консоли и поместите её в надёжное место 

## Часть II - Проверка количества сожжённых предохранителей

1. Запустите пейлоад {% include inc/hekate.txt %} с помощью [Fusée Gelée](fusee-gelee){:target="_blank"}

	Для перемещения по меню, hekata используйте клавиши (VOL-) и (VOL+), для выбора - (POWER)
	{: .notice--info}
	
1. Перейдите в меню "Console info..." -> "Print fuse info"
1. Запомните или запишите число напротив строки "Burnt fuses" - оно и будет означать количество сожжённых предохранителей. 
	* 1 сгоревший соответствуют прошивке 1.0.0
	* 2 сгоревших соответствуют прошивке 2.0.0-2.3.0
	* 3 сгоревших соответствуют прошивке 3.0.0
	* 4 сгоревших соответствуют прошивке 3.0.1-3.0.2
	* 5 сгоревших соответствуют прошивке 4.0.0-4.1.0
	* 6 сгоревших соответствуют прошивке 5.х.х
1. Нажмите любую кнопку для выхода в меню
1. Выберите "Back", чтобы вернуться в главное меню

## Часть III - Обновление прошивки

1. Включите приставку и активируйте интернет-соединение
1. Вставьте замыкатель в место крепления правого joy-con
1. Перейдите в "Системные настройки" -> "Система"  -> "Обновление системы" и согласитесь на обновление 
1. Ближе к окончанию обновления системы зажмите и удерживайте клавишу (VOL+)
	* Только её, кнопку (POWER) трогать не нужно
1. Как только обновление закончится, система автоматически перезагрузится, но так как вы удерживали (VOL+) и был вставлен замыкатель, система загрузится прямо в RCM

## Часть IV - Активация AutoRCM

1. Запустите пейлоад [brickmii](https://switchtools.sshnuke.net/){:target="_blank"} с помощью [Fusée Gelée](fusee-gelee){:target="_blank"}, держите в уме, что приставка уже в RCM
1. На Switch откроется окно программы "brickmii" - эта программа создана для контроля режима AutoRCM 

	AutoRCM - на консоли специальным образом портится BOOT0, вследствие чего консоль не может загрузиться прямо в систему и загружается автоматически в режим RCM. Достаточно просто включить консоли и она автоматически попадёт в режим восстановления. Не нужно зажимать комбинацию кнопок и использовать замыкатель!
	{: .notice--info}

1. Нажмите (VOL+) для отключения AutoRCM
1. Нажмите (POWER) для перезагрузки консоли в режим RCM 
1. Снова передайте пейлоад [brickmii](https://switchtools.sshnuke.net/){:target="_blank"} на консоль с помощью [Fusée Gelée](fusee-gelee){:target="_blank"}
1. Нажмите (VOL-) для включения AutoRCM
1. Нажмите (POWER) для перезагрузки консоли в режим RCM 

	Теперь приставка всегда при включении будет находится в режиме RCM. Не отключайте AutoRCM, если не хотите сжечь предохранитель. Единственная загрузка консоли вне этого режима гарантированно сожжёт предохранитель!

1. Проверьте не сгорели ли после обновления предохранители, выполнив ещё раз [Часть II](#%D0%A7%D0%B0%D1%81%D1%82%D1%8C-ii---%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0-%D0%BA%D0%BE%D0%BB%D0%B8%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%B0-%D1%81%D0%BE%D0%B6%D0%B6%D1%91%D0%BD%D0%BD%D1%8B%D1%85-%D0%BF%D1%80%D0%B5%D0%B4%D0%BE%D1%85%D1%80%D0%B0%D0%BD%D0%B8%D1%82%D0%B5%D0%BB%D0%B5%D0%B9){:target="_blank"}

## Часть V - Первый запуск 

1. Запустите пейлоад {% include inc/hekate.txt %} с помощью [Fusée Gelée](fusee-gelee){:target="_blank"}, имея ввиду, что после выключения консоли вы автоматически попадаете в режим RCM 

	Для перемещения по меню, hekata используйте клавиши (VOL-) и (VOL+), для выбора - (POWER)
	{: .notice--info}
	
1. Перейдите в меню, соответствующее прошивке с которой вы обновлялись:
	* при обновлении с **1.0.0 по 3.0.0** включительно выберите **CFW + nogc** или **ReiNX + nogc**
	* при обновлении с **4.0.0** и выше выберите **CFW** или **ReiNX**
1. Приставка загрузится в штатном режиме 

Теперь при каждом запуске **CFW + nogc** или **ReiNX + nogc** у вас будет запускаться кастомная прошивка, чистится логи, отключается проверка подписи и патчится системный модуль, позволяющий не обновлять прошивку слота для картриджей. Если вы захотите запустить другую конфигурацию hekate, не забудьте добавить строку `kip1=kip1patch=nogc,nosigchk` в конфиг. Помните, что запуск другой прошивки без этого модуля приведут к обновлению прошивки слота и при даунгрейде на прошивку ниже, чем 4.0.0 он перестанет работать! Это значит, что слот не будет работать ТОЛЬКО на прошивке ниже, чем 4.0.0. На любой прошивке выше он будет работать в обычном режиме! 
{: .notice--warning}

Обратите внимание, что при выборе **CFW + nogc** или **ReiNX + nogc** у вас перестанет работать слот картриджа на прошивке 5.1.0. Это не ошибка, это сделано намеренно, чтобы не дать прошивке слота вашего картриджа обновиться! 

# Предупреждения

* Если вы будете заменять файл `hekate_ipl.ini` на другой, не забудьте [прописать строчку](#подготовительные-работы){:target="_blank"} `kip1patch=nogc,nosigchk` в конфиг
* При обновлении прошивки AutoRCM слетает 
* При установке драйвера exFAT AutoRCM слетает 
* Даже один единственный запуск приставки в официальную прошивку не через hekate сожжёт предохранители, которые мы так отчаянно пытались сохранить 

ВНИМАНИЕ!! Если после загрузки прошивки ваша приставка не видит карты памяти в формате exFAT - напишите [мне](http://vk.com/rashevskyv){:target="_blank"} об этом!!!
{: .notice--danger}

___

# Следующий шаг: [Запуск кастомной прошивки](launch-cfw) 
{: .notice--success}