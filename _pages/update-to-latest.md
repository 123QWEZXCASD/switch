---
permalink: /update-to-latest.html
title: Безопасное обновление прошивки 
author_profile: true
---
{% include toc title="Разделы" %}

# Теоретическая часть

Если вы хотите получить поддержку exFAT, полностью следуйте этому руководству. Действия для активации exFAT и для поднятия прошивки идентичный!
{: .notice--info}

Если ваша прошивка выше, чем 4.1.0 включительно и вы не запускали ещё взлом, просто обновите её через настройки. 
{: .notice--info}

Для удобства использования взлома в данный момент лучшим решением будет обновить прошивку до актуальной - **{% include /vars/sys_version.txt %}**. Однако, если ваша прошивка была ниже, чем 4.0.0, наиболее правильным решением в такой ситуации будет обновление с возможностью даунгрейда. На прошивках до 4.0.0 включительно осталась потенциальная возможность установки колдбута. То есть после того, как он выйдет, мы сможем запускать кастомную прошивку вообще безо всяких манипуляций со входом в RCM и прочее. 

При прошивке на мажорные версии (1.0.0, 2.0.0, 5.0.0, 6.0.0) приставка сжигает специальные предохранители на чипе, чтобы по их состоянию отслеживать версию вашей прошивки и избегать даунгрейд. В обычном режиме при установке прошивки, консоль проверяет количество сожжённых предохранителей. Если это количество больше, чем требуется для прошивки, то консоль понимает, что вы пытаетесь установить прошивку ниже, чем была установлена до этого и не позволит это сделать. Если же количество сожжённых предохранителей ниже, чем требует устанавливаемая прошивка, то прошивка разрешается и в ходе неё сжигается столько предохранителей сколько необходимо, чтобы соответствовать указанному в прошивке количеству. Таким образом вы не можете восстановить бекап своей старой прошивки, если её версия ниже, чем текущая.

Однако, все это можно обойти. Так как проверка происходит во время запуска приставки, можно делать этот запуск через модифицированный загрузчик, который не будет проводить эту проверку. Фактически - запускать кастом. 

Так же стоит сказать, что в прошивке 4.0.0 используется новый драйвер для картриджного слота. Если вы обновите приставку с прошивки ниже, чем 4.0.0, то драйвер для слота обновится автоматически. Таким образом слот для картриджей будет работать только на прошивке выше, чем 4.0.0. Если вам когда-либо понадобится вернуться на старую прошивку, то там слот уже работать не будет. Для того, чтобы избежать этого всем, кто обновлялся с 1.0.0-4.0.0 включительно, нужно будет загружать прошивку с **NOGC**. Как это сделать будет рассказано ниже. И ещё раз - NOGC вам не нужен, если вы обновлялись с 4.1.0 или выше! Пользователи SX OS не имеют возможности избежать прошивки слота, поскольку не имеют возможности загружать внешние модули. 

Загрузившись без NOGC хотя бы раз, вы обновите драйвера автоматически. Но не стоит переживать. Вряд ли вам когда-нибудь понадобится слот для картриджа на старой прошивке. 

В прошивках с активированным NOGC слот для картриджа не работает. 

# Что понадобится

* Умение [запускать пейлоады через Fusée Gelée](fusee-gelee){:target="_blank"} и [кастомную прошивку](launch-cfw){:target="_blank"}
* Свежая версия [SDFiles от VK:3ds_cfw](https://github.com/rashevskyv/switch/releases/latest){:target="_blank"}
* Свежая версия [ChoiDujourNX](https://switchtools.sshnuke.net/){:target="_blank"}
* Прошивка {% include /vars/sys_version.txt %}:
	* [ЯД](https://yadi.sk/d/Qaaj2QznA1wc_g){:target="_blank"}
	* [MEGA](https://mega.nz/#!otVQCagA!OzSENIs6Z8oNMVJPQFKhQSYu3rre01xRejZNKCkc40o){:target="_blank"}
	* [FEX](https://fex.net/674993139076?fileId=847196292){:target="_blank"}
* Карта памяти 

# Инструкция

## Часть I - Резервное копирование NAND

Пропустите эту часть, если у вас уже есть резервная копия!

Если резервной копии нет, эту часть нужно делать **обязательно**!
{: .notice--danger}

1. Создайте [резервную копию NAND](backup-nand){:target="_blank"} консоли и поместите её в надёжное место 

## Часть II - Подготовка к обновлению

1. Выключите Switch и вставьте его карту памяти в ПК 
1. Отформатируйте карту, которую собираетесь использовать в FAT32 стандартными средствами вашей ОС, если она в другой файловой системе
	* Это удалит все данные с карты. Сделайте резервные копию всех важных данных, перед форматированием!
	* Можете просто использовать любую другую карту в fat32, 4ГБ хватит с головой для обновления 
	* Форматируйте карту [таким](https://3ds.customfw.xyz/clean_sd#ii-%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-sd-%D0%BA%D0%B0%D1%80%D1%82%D1%8B){:target="_blank"} способом, если не удаётся сделать этого прямо через Windows
1. Установите `.zip`-архива [SDFiles от VK:3ds_cfw](https://github.com/rashevskyv/switch/releases/latest){:target="_blank"}, согласно инструкции в репозитории, если ещё не делали этого
1. Скопируйте содержимое `.zip`-архива с прошивкой {% include /vars/sys_version.txt %} в корень карты памяти

## Часть III - Обновление прошивки

1. Запустите [кастомную прошивку](launch-cfw){:target="_blank"}
	* Если по каким-то причинам у вас не запускается кастомная прошивка, воспользуйтесь [обновлением вручную](update-to-latest_old)! Однако, рекомендую все-таки разобраться с причиной её неработоспособности!
1. Откройте [Homebrew Launcher](launch-hbl){:target="_blank"}
1. Запустите **ChoiDujourNX**
	* Если по каким-то причинам у вас не запускается ChoiDujourNX, попробуйте запустить его из под другого кастома, если и это не помогает, воспользуйтесь [обновлением вручную](update-to-latest_old)! Однако, рекомендую все-таки разобраться с причиной его неработоспособности!
1. Перейдите в папку, в которой находится прошивка {% include /vars/sys_version.txt %}, скопированная ранее и нажмите "**Choose**"
1. Выберите "**{% include /vars/sys_version.txt %} (exFAT)**"
1. Дождитесь окончания обработки прошивки и нажмите "**Select firmware**"
1. Дождитесь окончания распаковки прошивки и нажмите "**Start installation**"
1. После окончания установки нажмите "**Reboot**", "**Reboot now!**", чтобы выключить приставку 

Вы можете удалить папку с прошивкой {% include /vars/sys_version.txt %} с карты памяти. 
{: .notice--warning}

## Часть V - AutoRCM

AutoRCM - на консоли специальным образом изменяется загрузочный сектор, вследствие чего консоль не может загрузиться прямо в систему и загружается автоматически в режим RCM. Достаточно просто включить консоли и она автоматически попадёт в режим восстановления. Не нужно зажимать комбинацию кнопок и использовать замыкатель, но пейлоад для запуска прошивки всё равно передавать нужно!
{: .notice--info}

После обновления через ChoiDujourNX AutoRCM будет включен автоматически. Теперь приставка всегда при включении будет находится в режиме RCM. Не отключайте AutoRCM, если не хотите сжечь предохранитель. Единственная загрузка консоли вне этого режима гарантированно сожжёт предохранитель!

# Обновление с серверов Nintendo 

Вариант для внимательных и самоуверенных. Если вы ни разу ещё не запускали кастом, то можете обновить прошивку обычным способом. 

1. Включите приставку и подключитесь к активной интернет-сети
1. Перейдите в "**Настройки -> Система -> Обновление прошивки**" и начните обновление прошивки
1. Вместо правого джойкона вставьте [замыкатель](fusee-gelee#замыкатель){:target="_blank"}
1. Когда обновление закончится, удерживайте кнопку (VOL+). 

	К моменту перезагрузки консоли вы должны удерживать кнопку и замыкатель должен быть вставлен!
	{: .notice--warning}
	
1. Консоль должна загрузиться в режим RCM
	* Если консоль загрузилась в прошивку - ваши предохранители сгорели. Просто продолжайте выполнять инструкцию дальше и не грустите по этому поводу
1. Активируйте режим [AutoRCM](autorcm){:target="_blank"} и запустите прошивку

# Важно знать

* Если вы будете заменять файл `hekate_ipl.ini` на другой, не забудьте прописать строчку `kip1patch=nogc,nosigchk` в конфиг запускаемого кастома
* При обновлении прошивки средствами системы, AutoRCM слетает 
* При установке драйвера exFAT средствами системы, AutoRCM слетает 
* Даже один единственный запуск приставки в официальную прошивку не через hekate сожжёт предохранители, которые мы так отчаянно пытались сохранить 
* Если после прошивки вам предложат обновить контроллеры - обновляйте

# Зачем нужна NOGC 

Если вы обновились с прошивки индекс которой строго ниже, чем 4.0.0 на последнюю прошивку, то после обновления, при первом же запуске прошивки, вы так же обновите  и слот для картриджей. Это приведёт к тому, что захоти вы вернуться на первоначальную прошивку, вы лишитесь возможности использовать слот для картриджей. Нужен ли он вам будет - это вопрос. Поэтому, если вы обновлялись с прошивки строго ниже, чем 4.0.0 и у вас нет картриджей, которые бы вы могли использовать, не отключайте NOGC. В остальных случаях - на ваше усмотрение. Ещё раз - NOGC нужен только тем пользователям, что выполнял безопасное обновление с прошивки строго ниже, чем 4.0.0!

___

# Следующий шаг: [Запуск кастомной прошивки](launch-cfw) 
{: .notice--success}